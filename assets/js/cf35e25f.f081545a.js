(self.webpackChunkuniswap=self.webpackChunkuniswap||[]).push([[2556],{2776:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return a},contentTitle:function(){return l},metadata:function(){return s},toc:function(){return c},default:function(){return u}});var i=n(2122),o=n(9756),r=(n(7294),n(3905)),a={id:"removing",title:"Removing Liquidity"},l=void 0,s={unversionedId:"guides/liquidity/removing",id:"version-3.0.0/guides/liquidity/removing",isDocsHomePage:!1,title:"Removing Liquidity",description:"Removing Liquidity from a Position",source:"@site/SDK_versioned_docs/version-3.0.0/guides/liquidity/06-removing-liquidity.md",sourceDirName:"guides/liquidity",slug:"/guides/liquidity/removing",permalink:"/sdk/guides/liquidity/removing",version:"3.0.0",sidebarPosition:6,frontMatter:{id:"removing",title:"Removing Liquidity"},sidebar:"version-V3/sdksidebar",previous:{title:"Adding Liquidity",permalink:"/sdk/guides/liquidity/adding"},next:{title:"Creating a Trade",permalink:"/sdk/guides/creating-a-trade"}},c=[{value:"Removing Liquidity from a Position",id:"removing-liquidity-from-a-position",children:[]},{value:"The example code",id:"the-example-code",children:[]}],p={toc:c};function u(e){var t=e.components,n=(0,o.Z)(e,["components"]);return(0,r.kt)("wrapper",(0,i.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"removing-liquidity-from-a-position"},"Removing Liquidity from a Position"),(0,r.kt)("p",null,"Use the function ",(0,r.kt)("inlineCode",{parentName:"p"},"removeCallParameters")," with the ",(0,r.kt)("inlineCode",{parentName:"p"},"position")," instantiated earlier and a ",(0,r.kt)("inlineCode",{parentName:"p"},"RemoveLiquidityOptions")," interface. The reference for ",(0,r.kt)("a",{parentName:"p",href:"https://docs.uniswap.org/sdk/reference/interfaces/RemoveLiquidityOptions"},(0,r.kt)("inlineCode",{parentName:"a"},"RemoveLiquidityOptions"))," is:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"/**\n * Options for producing the calldata to exit a position.\n */\nexport interface RemoveLiquidityOptions {\n  /**\n   * The ID of the token to exit\n   */\n  tokenId: BigintIsh\n\n  /**\n   * The percentage of position liquidity to exit.\n   */\n  liquidityPercentage: Percent\n\n  /**\n   * How much the pool price is allowed to move.\n   */\n  slippageTolerance: Percent\n\n  /**\n   * When the transaction expires, in epoch seconds.\n   */\n  deadline: BigintIsh\n\n  /**\n   * Whether the NFT should be burned if the entire position is being exited, by default false.\n   */\n  burnToken?: boolean\n\n  /**\n   * The optional permit of the token ID being exited, in case the exit transaction is being sent by an account that does not own the NFT\n   */\n  permit?: NFTPermitOptions\n\n  /**\n   * Parameters to be passed on to collect\n   */\n  collectOptions: Omit<CollectOptions, 'tokenId'>\n}\n")),(0,r.kt)("p",null,"To remove liquidity from a position, set the parameters for ",(0,r.kt)("inlineCode",{parentName:"p"},"tokenId"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"liquidityPercentage"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"slippageTolerance"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"deadline"),", and ",(0,r.kt)("inlineCode",{parentName:"p"},"collectOptions"),". "),(0,r.kt)("p",null,"The reference for ",(0,r.kt)("inlineCode",{parentName:"p"},"CollectOptions")," is "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"export interface CollectOptions {\n  /**\n   * Indicates the ID of the position to collect for.\n   */\n  tokenId: BigintIsh\n\n  /**\n   * Expected value of tokensOwed0, including as-of-yet-unaccounted-for fees/liquidity value to be burned\n   */\n  expectedCurrencyOwed0: CurrencyAmount<Currency>\n\n  /**\n   * Expected value of tokensOwed1, including as-of-yet-unaccounted-for fees/liquidity value to be burned\n   */\n  expectedCurrencyOwed1: CurrencyAmount<Currency>\n\n  /**\n   * The account that should receive the tokens.\n   */\n  recipient: string\n}\n")),(0,r.kt)("p",null,"The parameter inputs are outlined below for ",(0,r.kt)("inlineCode",{parentName:"p"},"RemoveLiquidityOptions"),":"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"the",(0,r.kt)("inlineCode",{parentName:"li"},"tokenId")," is again set to 1 for this example, but refers to the unique id of the position nft. "),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"liquidityPercentage")," represents the amount of liquidity to remove. Adjust this parameter based on how much liquidity you want to remove. Set it to ",(0,r.kt)("inlineCode",{parentName:"li"},"Percent(1)")," to remove all liquidity. "),(0,r.kt)("li",{parentName:"ul"},"This example sets ",(0,r.kt)("inlineCode",{parentName:"li"},"slipppageTolerance")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"deadline")," to the same values as the previous examples. "),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"collectOptions")," defines the tokens to be collected and are passed onto ",(0,r.kt)("inlineCode",{parentName:"li"},"collect"),". This example collects the maximum amount of DAI and USDC. ")),(0,r.kt)("p",null,"When collecting fees in ETH, you must precompute the fees owed to protect against reentrancy attacks. In order to set a safety check, set the minimum fees owed in ",(0,r.kt)("inlineCode",{parentName:"p"},"expectedCurrencyOwed0")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"expectedCurrencyOwed1"),". To calculate this, quote the ",(0,r.kt)("inlineCode",{parentName:"p"},"collect")," function and store the amounts. The interface does similar behavior ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/Uniswap/uniswap-interface/blob/eff512deb8f0ab832eb8d1834f6d1a20219257d0/src/hooks/useV3PositionFees.ts#L32"},"here"),". For this example, it is not necessary to set a minimum amount of fees to collect because there is no concern with reentrancy for tokens (DAI/USDC)."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"const {calldata, value} = NonfungiblePositionManager.removeCallParameters(position, {\n        tokenId: 1,\n        liquidityPercentage: new Percent(1),\n        slippageTolerance: new Percent(50, 10_000),\n        deadline: deadline,\n        collectOptions: {\n          expectedCurrencyOwed0: CurrencyAmount.fromRawAmount(DAI, 0),\n          expectedCurrencyOwed1: CurrencyAmount.fromRawAmount(USDC, 0),\n          recipient: sender\n        }}\n    );\n")),(0,r.kt)("h2",{id:"the-example-code"},"The example code"),(0,r.kt)("p",null,"You now know how to mint a liquidity position, add liquidity, and remove liquidity. Here's the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/Uniswap/uniswap-docs/blob/main/sdk-examples/AddAndRemoveLiquidity.tsx"},"full example code")," for reference."))}u.isMDXComponent=!0},3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return p},kt:function(){return m}});var i=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,i,o=function(e,t){if(null==e)return{};var n,i,o={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=i.createContext({}),c=function(e){var t=i.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},p=function(e){var t=c(e.components);return i.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},d=i.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),d=c(n),m=o,f=d["".concat(s,".").concat(m)]||d[m]||u[m]||r;return n?i.createElement(f,a(a({ref:t},p),{},{components:n})):i.createElement(f,a({ref:t},p))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,a=new Array(r);a[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,a[1]=l;for(var c=2;c<r;c++)a[c]=n[c];return i.createElement.apply(null,a)}return i.createElement.apply(null,n)}d.displayName="MDXCreateElement"}}]);